# CSV 조회/가공 실시간 생산자/소비자 모델 구현

전 회사의 기억
- 예전회사에서는 주식데이터 트래픽 처리를 담당하는 데이터 서버 애플리케이션을 개발했었다.
- 데이터 처리의 시작 시점을 결정하는 것은 @RabbitListener와 ScheduledExecutor 3개에 의존해서 다른 호출자들의 흐름을 유발했고
- 작업자의 스레드풀은 대부분 java.util.concurrent , Executors 프레임웍 에서 제공하는 네가지 유명한 팩토리 메서드를 커스터마이징해서 Executor를 만들었었다.
- 작업자는 CompletableFuture 의 supplyAsync 에 Executor를 조합해 잘 활용했었다.
- 이렇게 해도 잘 동작했었다.
- 어떤 분은 갑자기 옵저버 패턴까지 물어보면서 궁금해 하던데... `아하...이분은 정말 책만 읽으신 분이구나` 했었다ㅋㅋ
- 그런데, 이 모델은 개발 초기에 kotlin, webflux 를 도입하겠다고 하는 것을 반대한 전회사의 팀장 덕분에 꽤 고루한 Java 8 이후의 비동기 스레드 모델로 설계해서 진행해왔었다. 어디든 면접을 가면 와 진짜 아직도 CompletableFuture 를 그대로 쓰는데가 있어? 하는 눈빛들 ㅎㅎㅎ
- 사실 그 팀장은 29살 정도의 어린 팀장이고, 철이 없다보니, 고집이 셌다. 그리고 어린 나이에 권위의식도 꽤 컸다.
- 그래서 프로젝트도 쉽게 될걸 어렵게 만들어서 팀원들을 계속 고생시켰다.
- 전 회사 이야기는 여기까지. 도저히 그 회사는 체력적으로도 물리적으로도 못버티겠다 싶어서 힘들어서 만 1년이 되었을때 나온거니깐 우울한 생각은 더 하고 싶지 않다.


CSV 조회/가공 실시간 생산자/소비자 모델 구현
- 전회사에서는 예전회사에서 어떻게든 주어진 자원과 팀장의 고집에 따라 주어진 java 계열의 기술스택을 잘 활용해서 어떻게든 결과물을 만들어야 했었다.
- 이번에는 Webflux 와 kotlin 을 활용해서 생산자 소비자 패턴을 구현해볼 예정이다.
- 끝을 볼수 있을까? 겁나긴 했는데 시작해봤다.
- 코프링 강의를 듣는데, `코루틴 이거 정말 굉장하구나` 싶었다.


# 2022-09-20 (화)
일단, 뭔가 구조를 만들기보다는 소규모 기능 위주로 작은 기능을 만들고 쌓아올려 나갈 예정이다.

오늘 생각해본 할일은 아래와 같다.
- CSV 파일 READ
- 인메모리 데이터 홀더 구현
- CSV 파일 READ 기능을 Buffer 방식으로 읽을 건데, Buffer 사이즈를 지정하는 청크단위 같은 단위로 읽어들여서 홀더에 적재하는 기능으로 전환하는 구조 설계
  - 현재 계획은 스케쥴러 기반으로 15ms에 한번씩 데이터 홀더 내의 데이터가 비어있으면 데이터를 청크 단위로 적재하는 방식을 계획중
- 그루핑 로직 설계, 리스폰스 객체 설계 (내일하게 될수도 있다 ㅠㅠ 구직 일정때문에...)